<?xml version="1.0" encoding="UTF-8"?>
<html xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <meta http-equiv="Expires" Content="-1"/>
        <meta http-equiv="Pragma" content="no-cache"/>
        <meta http-equiv="X-UA-compatible" content="IE=10,9"/>
        <title>Snap Relation Browser</title>
        <script type="text/javascript">
            

                // 
                // Globals
                // Major version of Flash required
                var requiredMajorVersion = 10;
                // Minor version of Flash required
                var requiredMinorVersion = 0;
                // Revision of Flash required
                var requiredRevision = 0;
                // the version of javascript supported
                var jsVersion = 1.0;
                // 

            
            function getQueryString(variable) {
            var query = window.location.search.substring(1);
            var vars = query.split("&amp;");
            for (var i=0;i&lt;vars.length; i++) {
                var pair = vars[i].split("=");
                if (pair[0] == variable) {
                return pair[1];
                }
                }
                }
                </script>
        <script type="text/vbscript">
                    
                    &lt;!-- // Visual basic helper required to detect Flash Player ActiveX control version information
                        Function VBGetSwfVer(i)
                        on error resume next
                        Dim swControl, swVersion
                        swVersion = 0
                        
                        set swControl = CreateObject("ShockwaveFlash.ShockwaveFlash." + CStr(i))
                        if (IsObject(swControl)) then
                        swVersion = swControl.GetVariable("$version")
                        end if
                        VBGetSwfVer = swVersion
                        End Function
                        // --&gt;
                        </script>
        <script type="text/javascript">
                    
// Detect Client Browser type
                        var isIE  = (navigator.appVersion.indexOf("MSIE") != -1) ? true : false;
                        var isWin = (navigator.appVersion.toLowerCase().indexOf("win") != -1) ? true : false;
                        var isOpera = (navigator.userAgent.indexOf("Opera") != -1) ? true : false;
                        jsVersion = 1.1;
                        // JavaScript helper required to detect Flash Player PlugIn version information
                        function JSGetSwfVer(i){
                        // NS/Opera version &gt;= 3 check for Flash plugin in plugin array
                        if (navigator.plugins != null &amp;&amp; navigator.plugins.length &gt; 0) {
                        if (navigator.plugins["Shockwave Flash 2.0"] || navigator.plugins["Shockwave Flash"]) {
                        var swVer2 = navigator.plugins["Shockwave Flash 2.0"] ? " 2.0" : "";
                        var flashDescription = navigator.plugins["Shockwave Flash" + swVer2].description;
                        descArray = flashDescription.split(" ");
                        tempArrayMajor = descArray[2].split(".");
                        versionMajor = tempArrayMajor[0];
                        versionMinor = tempArrayMajor[1];
                        if ( descArray[3] != "" ) {
                        tempArrayMinor = descArray[3].split("r");
                        } else {
                        tempArrayMinor = descArray[4].split("r");
                        }
                        versionRevision = tempArrayMinor[1] &gt; 0 ? tempArrayMinor[1] : 0;
                        flashVer = versionMajor + "." + versionMinor + "." + versionRevision;
                        } else {
                        flashVer = -1;
                        }
                        }
                        // MSN/WebTV 2.6 supports Flash 4
                        else if (navigator.userAgent.toLowerCase().indexOf("webtv/2.6") != -1) flashVer = 4;
                        // WebTV 2.5 supports Flash 3
                        else if (navigator.userAgent.toLowerCase().indexOf("webtv/2.5") != -1) flashVer = 3;
                        // older WebTV supports Flash 2
                        else if (navigator.userAgent.toLowerCase().indexOf("webtv") != -1) flashVer = 2;
                        // Can't detect in all other cases
                        else {
                        
                        flashVer = -1;
                        }
                        return flashVer;
                        } 
                        // If called with no parameters this function returns a floating point value 
                        // which should be the version of the Flash Player or 0.0 
                        // ex: Flash Player 7r14 returns 7.14
                        // If called with reqMajorVer, reqMinorVer, reqRevision returns true if that version or greater is available
                        function DetectFlashVer(reqMajorVer, reqMinorVer, reqRevision) 
                        {
                        reqVer = parseFloat(reqMajorVer + "." + reqRevision);
                        // loop backwards through the versions until we find the newest version	
                        for (i=25;i&gt;0;i--) {	
                        if (isIE &amp;&amp; isWin &amp;&amp; !isOpera) {
                        versionStr = VBGetSwfVer(i);
                        } else {
                        versionStr = JSGetSwfVer(i);		
                        }
                        if (versionStr == -1 ) { 
                        return false;
                        } else if (versionStr != 0) {
                        if(isIE &amp;&amp; isWin &amp;&amp; !isOpera) {
                        tempArray         = versionStr.split(" ");
                        tempString        = tempArray[1];
                        versionArray      = tempString .split(",");				
                        } else {
                        versionArray      = versionStr.split(".");
                        }
                        versionMajor      = versionArray[0];
                        versionMinor      = versionArray[1];
                        versionRevision   = versionArray[2];
                        
                        versionString     = versionMajor + "." + versionRevision;   // 7.0r24 == 7.24
                        versionNum        = parseFloat(versionString);
                        // is the major.revision &gt;= requested major.revision AND the minor version &gt;= requested minor
                        if ( (versionMajor &gt; reqMajorVer) &amp;&amp; (versionNum &gt;= reqVer) ) {
                        return true;
                        } else {
                        return ((versionNum &gt;= reqVer &amp;&amp; versionMinor &gt;= reqMinorVer) ? true : false );	
                        }
                        }
                        }	
                        return (reqVer ? false : 0.0);
                        }
                        // --&gt;
                        </script>
    </head>
    <body bgcolor="#eefffd" onLoad="loadFile('s');">
        <div>
            <a href="../index.html">Home</a>
        </div>  
        <!--url's used in the movie-->
        <!--  
            <div style="text-align:center;">
            <span>Snap Navigator|</span>
            <span>
                Search Term: <input id="searchTerm" size="40" type="text" placeholder="This is not working yet"/><span>This search is not working yet</span>
                <input type="button" value="Search" onclick="loadFile(document.getElementById('searchTerm').value);" />
            </span>         
        </div>
        <hr/>
        -->
        <div id="movie" style="text-align:center;"/>
        <!--text used in the movie-->
        <script language="JavaScript" type="text/javascript">
            
            &lt;!-- 
                
                var hasRightVersion = DetectFlashVer(requiredMajorVersion, requiredMinorVersion, requiredRevision);
                
                
                function loadFile(txt){
                if(hasRightVersion) {  // if we've detected an acceptable version
                var rnd = Math.random();
                // alert(rnd);  // used to ensure that the Flash cache is cleared each time a new page is called
                var oeTags = '&lt;object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'
                + 'width="1000px" height="1200px"'
                + 'codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab"&gt;'
                + '&lt;param name="movie" value="RelationBrowser.swf?dataSource=xmlTriples2relationBrowser.xql%3Fuid%3D' + getQueryString("uid") + '%26rnd%3D' + rnd + '" /&gt;'
                + '&lt;param name="quality" value="high" /&gt;'
                + '&lt;param name="bgcolor" value="#eefffd" /&gt;'
                + '&lt;embed src="RelationBrowser.swf?dataSource=xmlTriples2relationBrowser.xql%3Fuid%3D' + getQueryString("uid") + '%26rnd%3D' + rnd + '"  quality="high" bgcolor="#eefffd" '
                + 'width="100%" height="100%" name="RelationBrowser" align="middle"'
                + 'play="true"'
                + 'loop="false"'
                + 'quality="high"'
                + 'allowScriptAccess="sameDomain"'
                + 'type="application/x-shockwave-flash"'
                + 'pluginspage="http://www.macromedia.com/go/getflashplayer"&gt;'
                + '&lt;\/embed&gt;'
                + '&lt;\/object&gt;';
                document.getElementById("movie").innerHTML=(oeTags);   // embed the flash movie
                } else {  // flash is too old or we can't detect the plugin
                var alternateContent = 'Alternate HTML content should be placed here.'
                + 'This content requires the Macromedia Flash Player.'
                + '&lt;a href=http://www.macromedia.com/go/getflash/&gt;Get Flash&lt;/a&gt;';
                document.write(alternateContent);  // insert non-flash content
                }
                //alert(oeTags);
                }
                
                
                // --&gt;
                </script>
    </body>
</html>